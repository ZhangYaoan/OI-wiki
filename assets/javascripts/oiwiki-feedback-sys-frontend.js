(function(q,M){typeof exports=="object"&&typeof module<"u"?M(exports):typeof define=="function"&&define.amd?define(["exports"],M):(q=typeof globalThis<"u"?globalThis:q||self,M(q.OIWikiFeedbackSysFrontend={}))})(this,function(q){"use strict";const M='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M7 14h10q.425 0 .713-.288T18 13t-.288-.712T17 12H7q-.425 0-.712.288T6 13t.288.713T7 14m0-3h10q.425 0 .713-.288T18 10t-.288-.712T17 9H7q-.425 0-.712.288T6 10t.288.713T7 11m0-3h10q.425 0 .713-.288T18 7t-.288-.712T17 6H7q-.425 0-.712.288T6 7t.288.713T7 8M4 18q-.825 0-1.412-.587T2 16V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v15.575q0 .675-.612.938T20.3 20.3L18 18zm14.85-2L20 17.125V4H4v12zM4 16V4z"/></svg>',X='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6z"/></svg>';let $="/api";const Y=t=>{$=t};let A;const Z=async()=>{const t=await fetch(`${$}meta/github-app`,{method:"GET"});if(!t.ok)throw t;A||(A=(await t.json()).data)},tt=()=>{const t=new URL(window.location.href),e=t.searchParams.get("oauth_token");e&&(document.cookie=`oauth_token=${e}; path=/; expires=${new Date(JSON.parse(atob(e.split(".")[1])).exp*1e3).toUTCString()}; secure`,t.searchParams.delete("oauth_token"),window.history.replaceState(null,"",t.toString()))},H=()=>document.cookie.replace(/(?:(?:^|.*;\s*)oauth_token\s*\=\s*([^;]*).*$)|^.*$/,"$1"),D=()=>{const t=H();if(!t)return;const e=t.split(".")[1],c=Array.from(atob(e),a=>a.charCodeAt(0)),o=new TextDecoder("utf-8").decode(new Uint8Array(c));return JSON.parse(o)},W=()=>{document.cookie="oauth_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; secure"},et='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M5.85 17.1q1.275-.975 2.85-1.537T12 15t3.3.563t2.85 1.537q.875-1.025 1.363-2.325T20 12q0-3.325-2.337-5.663T12 4T6.337 6.338T4 12q0 1.475.488 2.775T5.85 17.1M12 13q-1.475 0-2.488-1.012T8.5 9.5t1.013-2.488T12 6t2.488 1.013T15.5 9.5t-1.012 2.488T12 13m0 9q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"/></svg>',nt='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M17 22q-1.25 0-2.125-.875T14 19q0-.15.075-.7L7.05 14.2q-.4.375-.925.588T5 15q-1.25 0-2.125-.875T2 12t.875-2.125T5 9q.6 0 1.125.213t.925.587l7.025-4.1q-.05-.175-.062-.337T14 5q0-1.25.875-2.125T17 2t2.125.875T20 5t-.875 2.125T17 8q-.6 0-1.125-.213T14.95 7.2l-7.025 4.1q.05.175.063.338T8 12t-.012.363t-.063.337l7.025 4.1q.4-.375.925-.587T17 16q1.25 0 2.125.875T20 19t-.875 2.125T17 22"/></svg>',ot='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"/></svg>',at='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zm2-4h2V8H9zm4 0h2V8h-2z"/></svg>',it=function(t,e){return t.reduce((c,o)=>((c[e(o)]=c[e(o)]||[]).push(o),c),{})},G=new Intl.DateTimeFormat("zh-CN",{dateStyle:"short",timeStyle:"short"});let m=null,i,j,v;const st=()=>{i=void 0},ct=t=>{j=t},rt=t=>{v=t},dt=async()=>{var y;const e=new URL(window.location.href).hash;if(!e)return;const c=(y=/#comment-(\d+)/.exec(e))==null?void 0:y[1];if(!c)return;const o=parseInt(c);await L();const a=i==null?void 0:i.find(w=>w.id===o);if(!a)return;const n=[a.offset.start,a.offset.end],p=document.querySelector(`[data-review-enabled][data-original-document-start="${n[0]}"][data-original-document-end="${n[1]}"]`);if(!p)return;await F({el:p,forceOpenCommentsPanel:!0});const d=document.querySelector(`.comment[data-id="${o}"]`);d==null||d.classList.add("comment_highlighting"),d==null||d.scrollIntoView({behavior:"smooth",block:"center"})},F=async({el:t,forceOpenCommentsPanel:e=!1})=>{m!==t&&(m==null||delete m.dataset.reviewSelected,m=t),(m!=null&&m.dataset.reviewHasComments||e)&&(delete m.dataset.reviewFocused,m.dataset.reviewSelected="true",await T(e))},mt=()=>{m==null||delete m.dataset.reviewSelected,m=null},T=async(t=!0)=>{const e=[...await L()],c=m;c&&e.find(a=>a.offset.start===parseInt(c.dataset.originalDocumentStart)&&a.offset.end===parseInt(c.dataset.originalDocumentEnd))===void 0&&e.push({id:-1,offset:{start:parseInt(c.dataset.originalDocumentStart),end:parseInt(c.dataset.originalDocumentEnd)},commenter:{name:"",oauth_provider:"github",oauth_user_id:""},comment:"",created_time:new Date().toISOString(),last_edited_time:null,pending:!0}),await _t(e);let o=document.querySelector(`#review-comments-panel .comments_group[data-original-document-start="${m==null?void 0:m.dataset.originalDocumentStart}"][data-original-document-end="${m==null?void 0:m.dataset.originalDocumentEnd}"]`);if(o&&(o.dataset.reviewSelected="true"),o==null||o.scrollIntoView({behavior:"smooth",block:"start"}),t){const a=o==null?void 0:o.querySelector(".comment_actions_panel textarea");a==null||a.focus()}j.classList.add("review_hidden"),v.classList.remove("review_hidden")},N=()=>{v.classList.add("review_hidden"),j.classList.remove("review_hidden")},lt=async({offsets:t,content:e})=>{var d,y,w;const c=sessionStorage.getItem("commitHash");if(!c)throw new Error("找不到 Commit hash，请联系站点管理员");const o={offset:{start:t[0],end:t[1]},comment:e},a=fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${H()}`},body:JSON.stringify({...o,commit_hash:c})}),n=(i==null?void 0:i.length)??-1;i&&i.push({...o,commenter:{name:((d=D())==null?void 0:d.name)??"未知用户",oauth_provider:(y=D())==null?void 0:y.provider,oauth_user_id:((w=D())==null?void 0:w.id)??"-1"},id:i.length,created_time:new Date().toISOString(),last_edited_time:null,pending:!0});const p=await a;if(!p.ok)throw i&&(i=i.filter(g=>g.id!==n)),p;i&&(i=i.map(g=>g.id===n?{...g,pending:!1}:g)),await L(!0),z()},ut=async({id:t,comment:e})=>{const c=fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}/id/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${H()}`},body:JSON.stringify({comment:e})});i&&(i=i.map(a=>a.id===t?{...a,pending:!0}:a));const o=await c;if(!o.ok)throw i&&(i=i.map(a=>a.id===t?{...a,pending:!1}:a)),o;i&&(i=i.map(a=>a.id===t?{...a,comment:e,pending:!1}:a)),await L(!0),z()},ft=async({id:t})=>{const e=fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}/id/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${H()}`}});i&&(i=i.map(o=>o.id===t?{...o,pending:!0}:o));const c=await e;if(!c.ok)throw i&&(i=i.map(o=>o.id===t?{...o,pending:!1}:o)),c;i&&(i=i.filter(o=>o.id!==t)),await L(!0),z()},L=async(t=!1)=>{if(!t&&i)return i;const e=await fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}`);if(!e.ok)throw e;const c=(await e.json()).data;return i=c,c},_t=async t=>{const e=v.querySelector(".panel_main"),c=document.createDocumentFragment(),o=it(t,a=>`${a.offset.start}-${a.offset.end}`);for(const a of Object.keys(o).sort((n,p)=>parseInt(n.split("-")[0])-parseInt(p.split("-")[0]))){const n=document.createElement("div");n.classList.add("comments_group");const p=a.split("-");n.dataset.originalDocumentStart=p[0],n.dataset.originalDocumentEnd=p[1];const d=document.querySelector(`[data-review-enabled][data-original-document-start="${n.dataset.originalDocumentStart}"][data-original-document-end="${n.dataset.originalDocumentEnd}"]`),y=(d==null?void 0:d.textContent)??"";n.innerHTML=`
      <div class="comments_group_header">
        <span class="comments_group_text_content">${y}</span>
      </div>
      <div class="comments_group_main"></div>
      <div class="comments_group_footer">
        <div class="comment_actions_panel">
          <div class="comment_actions_header">
            <span class="comment_username"></span>
            <button class="comment_actions_item" data-action="logout">退出登录</button>
          </div>
          <textarea required placeholder="写下你的评论..."  autocapitalize="sentences" autocomplete="on" spellcheck="true" maxlength="65535"></textarea>
          <div class="comment_actions_footer">
            <span class="comment_actions_notification"></span>
            <div class="comment_actions comment_actions_login">
              <button class="comment_actions_item comment_actions_item_btn comment_actions_item_btn_primary" data-action="login">登录到 GitHub</button>
            </div>
            <div class="comment_actions comment_actions_modify">
              <button class="comment_actions_item comment_actions_item_btn" data-action="modify_cancel">取消</button>
              <button class="comment_actions_item comment_actions_item_btn comment_actions_item_btn_primary" data-action="modify_submit">修改</button>
            </div>
            <div class="comment_actions comment_actions_reply">
              <button class="comment_actions_item comment_actions_item_btn" data-action="cancel">取消</button>
              <button class="comment_actions_item comment_actions_item_btn comment_actions_item_btn_primary" data-action="submit">提交</button>
            </div>
          </div>
        </div>
      </div>
    `.trim();const w=r=>{r.style.height="5px",r.style.height=r.scrollHeight+"px"};n.querySelector(".comment_actions_panel textarea").addEventListener("input",r=>{const s=r.currentTarget;w(s)});const g=n.querySelector(".comment_username"),V=n.querySelector(".comment_actions_login"),R=n.querySelector("button.comment_actions_item[data-action='logout']"),b=D();b?(g.textContent=`作为 ${b.name} 发表评论`,V.style.display="none"):(g.textContent="登录到 GitHub 以发表评论",R.style.display="none");const k=n.querySelector(".comment_actions_modify");k.style.display="none",n.addEventListener("mouseenter",()=>{d&&(d.dataset.reviewFocused="true")}),n.addEventListener("mouseleave",()=>{d==null||delete d.dataset.reviewFocused}),n.addEventListener("click",r=>{var s;r.stopPropagation(),m==null||delete m.dataset.reviewSelected,d==null||delete d.dataset.reviewFocused,d==null||delete d.dataset.reviewSelected,(s=document.querySelector(".comments_group[data-review-selected]"))==null||delete s.dataset.reviewSelected,n.dataset.reviewSelected="true",m=d,m==null||m.scrollIntoView({behavior:"smooth",block:"center"})});const gt=o[a].sort((r,s)=>new Date(r.created_time).getTime()-new Date(s.created_time).getTime()),bt=n.querySelector(".comments_group_main");for(const r of gt){if(r.id===-1)continue;const s=document.createElement("div");s.classList.add("comment"),r.pending&&s.classList.add("comment_pending"),s.dataset.id=r.id.toString(),s.innerHTML=`
        <div class="comment_container">
          <div class="comment_side">
            <div class="comment_user_avatar">
              <img src="${r.commenter.avatar_url}" alt="user avatar"/>
            </div>
          </div>
          <div class="comment_base">
            <div class="comment_header">
              <a class="comment_commenter"></a>
              <span class="comment_time comment_created_time">发布于 ${G.format(new Date(r.created_time))}</span>
              <span class="comment_time comment_edited_time">最后编辑于 ${r.last_edited_time?G.format(new Date(r.last_edited_time)):""}</span>
              <div class="comment_actions">
                <button class="comment_actions_item" data-action="copy_permalink" title="分享">${nt}</button>
                <button class="comment_actions_item comment_actions_item_administration" data-action="modify" title="编辑">${ot}</button>
                <button class="comment_actions_item comment_actions_item_administration" data-action="delete" title="删除">${at}</button>
              </div>
            </div>
            <div class="comment_main">
              <span class="comment_content"></span>
              <span class="comment_edit_tag">(已编辑)</span>
            </div>
          </div>
        </div>
        <div class="comment_tailing">
          <button class="comment_actions_item comment_expand" data-action="expand">展开</button>
          <button class="comment_actions_item comment_expand" data-action="fold">折叠</button>
        </div>
      `.trim();const f=s.querySelector(".comment_commenter");r.commenter.name&&(f.textContent=r.commenter.name,f.title=r.commenter.name);const _=s.querySelector(".comment_user_avatar");r.commenter.profile_url&&(f.target="_blank",f.href=r.commenter.profile_url,_.style.cursor="pointer",_.addEventListener("click",()=>{window.open(r.commenter.profile_url)})),r.commenter.avatar_url||(_.innerHTML=et),s.querySelector(".comment_main .comment_content").textContent=r.comment;const E=s.querySelector(".comment_header .comment_actions");let S=!0,B=!0;(!b||b.provider!==r.commenter.oauth_provider||b.id!==r.commenter.oauth_user_id)&&(S=!1),b&&b.isAdmin===!0&&(S=!0),r.id===-1&&(S=!1),S||E.querySelectorAll(".comment_actions_item_administration").forEach(U=>{U.style.display="none"}),!S&&!B&&(E.style.display="none");const I=s.querySelector(".comment_header .comment_created_time"),x=s.querySelector(".comment_header .comment_edited_time");x.style.display="none",r.last_edited_time&&I.addEventListener("click",()=>{I.style.display="none",x.style.display=""}),x.addEventListener("click",()=>{I.style.display="",x.style.display="none"});const P=s.querySelector(".comment_main .comment_edit_tag");r.last_edited_time||(P.style.display="none"),bt.appendChild(s)}for(const r of n.querySelectorAll(".comment_actions_item"))r.addEventListener("click",async()=>{var S,B,I,x,P,U;const s=r,f=n.querySelector(".comment_actions_panel textarea"),_=n.querySelector(".comment_actions_notification"),E=async l=>{var u;if(console.error(l),l instanceof Error)_.textContent=l.message;else if(l instanceof Response){if(l.status===401){_.textContent="身份验证失效，请重新登录",W();return}if(((u=l.headers.get("content-type"))==null?void 0:u.includes("application/json"))===!0){const h=await l.json();_.textContent=h.error}else _.textContent=`未知接口错误：${l.status}(${l.statusText})`}else _.textContent="提交失败，请稍后再试"};switch(s==null?void 0:s.dataset.action){case"copy_permalink":{s.dataset.tag="using";const l=n.querySelector(`.comment:has([data-tag="using"][data-action="${s==null?void 0:s.dataset.action}"])`);delete s.dataset.tag;const u=(S=l==null?void 0:l.dataset)==null?void 0:S.id;if(u==null)return;const h=new URL(window.location.href);h.hash=`#comment-${u}`,await navigator.clipboard.writeText(h.toString()),_.textContent="已复制评论链接地址";break}case"login":{if(!A){console.log("githubMeta not ready");return}window.location.href=`https://github.com/login/oauth/authorize?client_id=${A.client_id}&state=${encodeURIComponent(JSON.stringify({redirect:window.location.href}))}`;break}case"logout":{W(),window.location.reload();break}case"cancel":{f.disabled=!1,f.value="",_.textContent="",w(f);break}case"submit":{if(f.disabled=!0,!f.checkValidity()){_.textContent="请填写评论内容",f.disabled=!1;return}_.textContent="",await T();const l=v.querySelector("[data-review-selected] button[data-action='submit']");l&&(l.disabled=!0);try{await lt({offsets:[parseInt(m.dataset.originalDocumentStart),parseInt(m.dataset.originalDocumentEnd)],content:f.value}),f.value="",_.textContent=""}catch(u){E(u)}finally{await T();const u=v.querySelector("[data-review-selected] .comment_actions_notification"),h=v.querySelector("[data-review-selected] .comment_actions_panel textarea");u&&(u.textContent=_.textContent),h&&(h.value=f.value)}break}case"modify":{(B=n.querySelector(`.comment[data-id="${n.dataset.modifingId}"]`))==null||B.classList.remove("comment_pending"),s.dataset.tag="using";const l=n.querySelector(`.comment:has([data-tag="using"][data-action="${s==null?void 0:s.dataset.action}"])`);delete s.dataset.tag;const u=(I=l==null?void 0:l.dataset)==null?void 0:I.id;if(u==null)return;l==null||l.classList.add("comment_pending"),k.style.display="",n.dataset.modifingId=u,f.value=((x=i==null?void 0:i.find(C=>C.id===parseInt(u)))==null?void 0:x.comment)??"";const h=n.querySelector(".comments_group_footer");h.style.display="block",w(f),h.style.display="";break}case"modify_cancel":{(P=n.querySelector(`.comment[data-id="${n.dataset.modifingId}"]`))==null||P.classList.remove("comment_pending"),k.style.display="none",delete n.dataset.modifingId,f.disabled=!1,f.value="",_.textContent="",w(f);break}case"modify_submit":{const l=n.dataset.modifingId;if(l==null)return;await T();try{await ut({id:parseInt(l),comment:f.value}),f.value="",_.textContent=""}catch(u){E(u)}finally{await T();const u=v.querySelector("[data-review-selected] .comment_actions_notification"),h=v.querySelector("[data-review-selected] .comment_actions_panel textarea");u&&(u.textContent=_.textContent),h&&(h.value=f.value)}break}case"delete":{s.dataset.tag="using";const l=n.querySelector(`.comment:has([data-tag="using"][data-action="${s==null?void 0:s.dataset.action}"])`);delete s.dataset.tag;const u=(U=l.dataset)==null?void 0:U.id;if(u==null)return;ft({id:parseInt(u)}).catch(E).finally(()=>{T().then(()=>{const h=v.querySelector("[data-review-selected] .comment_actions_notification"),C=v.querySelector("[data-review-selected] .comment_actions_panel textarea");h&&(h.textContent=_.textContent),C&&(C.value=f.value)})}),T().then(()=>{const h=v.querySelector("[data-review-selected] .comment_actions_notification"),C=v.querySelector(`.comment[data-id="${u}"] button[data-action="delete"]`),Q=v.querySelector(`.comment[data-id="${u}"] button[data-action="modify"]`);h&&(h.textContent=_.textContent),C&&(C.disabled=!0),Q&&(Q.disabled=!0)});break}}});c.appendChild(n)}for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(c);for(const a of v.querySelectorAll(".comment")){const n=a.querySelector(".comment_main"),p=a.querySelector('.comment_tailing .comment_expand[data-action="expand"]'),d=a.querySelector('.comment_tailing .comment_expand[data-action="fold"]'),y=n.offsetHeight;n.scrollHeight<=y&&(p.style.display="none"),d.style.display="none",p.addEventListener("click",()=>{p.style.display="none",d.style.display="",n.style.maxHeight=n.scrollHeight+"px"}),d.addEventListener("click",()=>{p.style.display="",d.style.display="none",n.style.maxHeight=`${y}px`})}},z=async()=>{const t=Array.from(document.querySelectorAll("[data-review-enabled][data-original-document-start][data-original-document-end]"));await L();for(let e of t)delete e.dataset.reviewHasComments,i.find(c=>c.offset.start===parseInt(e.dataset.originalDocumentStart)&&c.offset.end===parseInt(e.dataset.originalDocumentEnd))&&(e.dataset.reviewHasComments="true")},J=({idOrClass:t,content:e,actions:c=new Map,parent:o=document.body,insertPosition:a="beforeend",tag:n="div",isClass:p=!1,initialize:d=()=>{}})=>{let y=document.querySelector(`#${t}`);if(!p&&y)return y;o.insertAdjacentHTML(a,`
    <${n} ${p?`class="${t}"`:`id="${t}"`}>
      ${e.trim()}
    </${n}>
    `.trim()),y=o.querySelector(p?`.${t}`:`#${t}`),d(y);const w=y.querySelectorAll("[data-action]");for(const g of w)g.addEventListener("click",V=>{var k;V.stopPropagation();const R=V.currentTarget,b=R.dataset.action??"";(k=c.get(b))==null||k(R)});return y},pt='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M11 11v2q0 .425.288.713T12 14t.713-.288T13 13v-2h2q.425 0 .713-.288T16 10t-.288-.712T15 9h-2V7q0-.425-.288-.712T12 6t-.712.288T11 7v2H9q-.425 0-.712.288T8 10t.288.713T9 11zm-5 7l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"/></svg>',ht=({el:t})=>{t.querySelector(".review-context-menu")||J({idOrClass:"review-context-menu",content:`
    <button data-action="comment">
      ${pt}
    </button>
    `,parent:t,actions:new Map([["comment",()=>{F({el:t,forceOpenCommentsPanel:!0})}]]),isClass:!0,initialize:e=>{e.addEventListener("mouseenter",()=>{t.dataset.reviewFocused="true"}),e.addEventListener("mouseleave",()=>{delete t.dataset.reviewFocused}),e.style.display="none"}})},yt=({el:t})=>{const e=t.querySelector(".review-context-menu");if(!e){console.error("openContextMenu called but contextMenu not found");return}e.style.display=""},vt=({el:t})=>{const e=t.querySelector('.review-context-menu:not([style*="display: none"])');if(!e){console.error("closeContextMenu called but contextMenu not found");return}e.style.display="none"};let O=!1;const K="0.5.8";function wt(t,{apiEndpoint:e="/api"}={}){Y(e.endsWith("/")?e:e+"/"),tt();const c=Array.from(t.querySelectorAll("[data-original-document-start][data-original-document-end]"));if(!c){console.warn("oiwiki-feedback-sys-frontend not found any offsets to inject, quitting...");return}for(let o of c)o.dataset.reviewEnabled="true",o.addEventListener("click",a=>{a.stopPropagation(),F({el:a.currentTarget})}),o.addEventListener("mouseenter",a=>{yt({el:a.currentTarget})}),o.addEventListener("mouseleave",a=>{vt({el:a.currentTarget})}),ht({el:o});if(st(),z(),Z(),O){N(),console.log("oiwiki-feedback-sys-frontend has been successfully reset.");return}document.addEventListener("click",()=>{mt()}),ct(J({idOrClass:"review-comments-button",content:`
    <button data-action="open">
      ${M}
    </button>
    `,actions:new Map([["open",()=>T()]])})),rt(J({idOrClass:"review-comments-panel",content:`
    <div class="panel_header">
      <span>本页评论</span>
      <button data-action="close">
        ${X}
      </button>
    </div>
    <div class="panel_main"></div>
    `,actions:new Map([["close",()=>N()]])})),N(),dt(),console.log(`oiwiki-feedback-sys-frontend version ${K} has been successfully installed.`),O=!0}q.__VERSION__=K,q.setupReview=wt,Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});
